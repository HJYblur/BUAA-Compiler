# 2021 BUAA 编译原理总结感想

***Author:19373611,何嘉怡***

这学期用了将近一整个学期的时间完成编译器的设计，在此过程折磨很多，挫折很多，但是最后学到的东西也很多。细想下来，有如下几点反思：

#### 理论的重要性

在生成中间代码和mips代码时，因为想偷懒只生成一个符号表两个部分一起用，所以自己构思了一种符号表架构。但是写着写着发现自己的符号表存在漏洞，就继续添加子对象使得这个符号表勉强能跑。但是写着写着又发现，自己想的架构终究是自己想的，经不起实践的验证，再次出现问题，而且不是靠添加一点对象就可以解决的。所以纠结再三，还是踏上了重构的不归路。

更为甚者，重构后发现仍然在函数参数部分仍然有问题，去复习理论的时候才发现自己一直记错了动态栈的结构：函数参数应该和函数内变量在一层而不是和函数定义在一层。

此外，在设计函数相关操作时，自己最开始也是一头雾水，完全不知道应该怎么处理。后来经过请教学长、同学后才明白函数栈的存储情况。同时学长也直接指出了：这是理论PPT第六节的内容，你没学明白。确实是，自己当时课上就没太听明白，课下又没有好好复习，导致实验要写的时候完全下不了手。

一言一概之，理论永远是实验的基础。一定要把理论学清楚学扎实。

#### 架构的重要性

在进行代码编写前一定要想好架构，同时考虑架构的可拓展性、可复用性。例如，在写词法分析和语法分析时我没有过多考虑错误处理需要的输出，直接利用pair结构存储元素。在错误处理时需要考虑的属性多起来后就发现这个结构不够使，进行了部分重构。

在考虑好架构后，代码的编写应该是行云流水的。如果意识到编写过程很阻塞，还是应该重新考虑是不是哪里没有设计好。此外，在写错误处理及之前的部分时重温了C++语言的诸多特性，也认识到了编译器的工作过程，可谓收获良多。

#### 合理安排作业完成时间

编译器的设计是一个迭代的过程。从最开始很简单的词法分析、语法分析，到逐渐复杂的代码生成，一步一步走过来，深深体悟了合理安排时间与计划的重要性。记得最开始可以一天内完成当时的任务，所以很放松，也争取领先于课程安排的进度。但后期随着大作业和任务越来越多，自己也开始逐渐分身乏力，无法匀出足够的时间去搭建。希望以后还是能更好的分配时间。



不得不说，重构虽苦，但是重构后的代码看起来就好多了，没有曾经x山的样子。在周末两天的时间里，也一直用大量数据去检验自己的架构。不得不说编译器确实还是一个大工程，大量数据检验出了很多细节的纰漏。最后AC的时候，也真的可以说是开心的手舞足蹈了。

过程虽苦，结果是美丽的。感谢这一学期的付出，感谢助教和老师的帮助教导。

